# 微服务

微服务（Microservices Architecture Pattern）由 Martin Fowler 在 2014 年提出的，是希望将某个单一的单体应用，转化为多个可以独立运行、独立开发、独立部署、独立维护的服务或者应用的聚合，从而满足业务快速变化及分布式多团队并行开发的需求。如康威定律（Conway’s Law）所言，任何组织在设计一套系统（广义概念）时，所交付的设计方案在结构上都与该组织的通信结构保持一致，微服务与微前端不仅仅是技术架构的变化，还包含了组织方式、沟通方式的变化；当我们在构建现实中的微服务系统中，其面临的问题又可以细化为服务拆分与服务治理等不同的考虑维度，微服务并不等同于我们选择了 Dubbo 或者 Spring Cloud 等某种微服务解决方案，而是源自内部的业务划分、组织架构。

![Typical MicroService Architecture](https://i.postimg.cc/mkMy155d/image.png)

微服务与微前端原理和软件工程，面向对象设计中的原理同样相通，都是遵循单一职责(Single Responsibility)、关注分离(Separation of Concerns)、模块化(Modularity)与分而治之(Divide & Conquer)等基本的原则。
对于微服务，不同背景的人也有不同的见解，对于熟悉 SOA 的开发者，微服务也可以认为是去除了 ESB 的 SOA 的一种实现方案；ESB 是 SOA 架构中的中心总线，设计图形应该是星形的，而微服务是去中心化的分布式软件架构。SOA 更多强调重用，而微服务偏向于重写。SOA 偏向水平服务，微服务偏向垂直服务；SOA 偏向自上而下的设计，微服务偏向自下而上的设计。

![典型的微服务之间连接](https://i.postimg.cc/XNmDQrKL/image.png)

# 微服务的挑战

人月神话一书中提及，没有银弹，意思是只靠一把锤子是盖不起摩天大楼的，要根据业务场景选择设计思路和实现工具。微服务的优势可以如下所述：

- 每个服务足够内聚，足够小，代码容易理解、开发效率提高
- 服务之间可以独立部署，微服务架构让持续部署成为可能；
- 每个服务可以各自进行 x 扩展和 z 扩展，而且，每个服务可以根据自己的需要部署到合适的硬件服务器上；
- 容易扩大开发团队，可以针对每个服务（Service）组建开发团队；
- 提高容错性（Fault Isolation），一个服务的内存泄露并不会让整个系统瘫痪；
- 系统不会被长期限制在某个技术栈上；

而其缺点也很明显：

- 开发与运维复杂度的增加：开发人员要设计服务之间的通信机制，对于需要多个后端服务的业务场景，要在没有分布式事务的情况下实现代码非常困难；涉及多个服务直接的自动化测试也具备相当的挑战性；
- 真实系统往往难以明确划分边界：在生产环境中要管理多个不同的服务的实例，这意味着开发团队需要全局统筹；
- 状态管理与通信的复杂度；
- 分布式事务与版本管理；

![](https://s2.ax1x.com/2019/12/10/QDzmVS.png)

![](https://s2.ax1x.com/2019/12/10/QDzl2n.png)
